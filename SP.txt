
CREATE PROCEDURE "crystal_sp_get_ar_invoice" 
(IN DocKey decimal(19, 0)) 
AS 
BEGIN 
SELECT OADM."CompnyName" AS "Company Name", OADM."CompnyAddr" AS "Company Address", OADM."Phone1" AS "Company Phone1"
, OADM."FreeZoneNo" AS "Company Reg No", OADM."TaxIdNum" AS "Company Vat No", ADM1."TaxIdNum6" AS "Company TPIN No",
OADM."Phone1" AS "Company Phone", OADM."Fax" AS "Company Fax", 'COPY TAX INVOICE' AS "Report Name",
CAST(T0."DocNum" AS varchar(50)) AS "Invoice No", T0."DocDate" AS "Invoice Date", 
CAST(T7."DocNum" AS varchar(50)) AS "Delivery No", T7."DocDate" AS "Delivery Date",
T0."NumAtCard" AS "Ref No", T6."PymntGroup", OSLP."SlpName", T0."DocDueDate" AS "Desired Ship Date", 
T0."CardName" AS "Customer Name", T0."Address2" AS "Customer Address", T3."E_Mail" AS "Customer Email",
T3."Phone1" AS "Customer Tel", CAST('' AS varchar(100)) AS "Contact Location",
'ZMW' "DocCur", 
'Zambian Kwacha' AS "Currencyname", 
'Ngwee' AS "Hundredthname", 
T1."ItemCode", T1."Dscription", 
T1."Quantity", CAST('' AS varchar(100)) AS "Packing Size", CAST(0 AS decimal(19, 2)) AS "Exc Per", 
CAST(0 AS decimal(19, 2)) AS "VAT", T1."unitMsr", T1."Price", T1."DiscPrcnt", T1."VatPrcnt", T1."LineTotal", 
T0."VatSum", T0."DiscSum" AS "Footer Discsum", CAST(0 AS decimal(19, 2)) AS "Excise Amount", T0."DocTotal",
T0."Comments" AS "Remark", '(1) Interest will be charge at the prevailing bank rate on all over due amounts above 21 days. (2) No Claims will be recognised unless notified in writing at the time of delivery. (3) Price ruling at the time delivery shall apply. (4) Goods remain the property of Gourock Zambia Limited until 
this invoice is fully paid.' AS "Terms and Condition", 
ODSC."BankName", DSC1."BranchName", DSC1."Account", ODSC."SwiftNum", ODSC."BankCode" ,
T8."U_NAME" AS "Prepared By",
T10."name" AS "Prepared By Desig",
T8."E_Mail" AS "Prepared By Email",
T8."PortNum" AS "Prepared By Contact",

T12."U_NAME" AS "Authorised By",
T14."name" AS "Authorised By Desig",
T12."E_Mail" AS "Authorised By Email",
T12."PortNum" AS "Authorised By Contact"

FROM OADM, ADM1, OINV T0 
INNER JOIN INV1 T1 ON T0."DocEntry" = T1."DocEntry" 
LEFT OUTER JOIN OCRD T3 ON T0."CardCode" = T3."CardCode" 
INNER JOIN NNM1 T5 ON T0."Series" = T5."Series" 
LEFT OUTER JOIN OCTG T6 ON T0."GroupNum" = T6."GroupNum" 
LEFT OUTER JOIN ODLN T7 ON T1."BaseEntry" = T7."DocEntry" 
LEFT OUTER JOIN OSLP  ON T0."SlpCode" = OSLP."SlpCode"
LEFT OUTER JOIN ODSC ON T3."BankCode" = ODSC."BankCode" 
LEFT OUTER JOIN DSC1 ON ODSC."BankCode" = DSC1."BankCode" 

LEFT JOIN OUSR T8 ON T0."UserSign" = T8."USERID"
LEFT JOIN OHEM T9 ON T8."USERID"= T9."userId"
LEFT JOIN OHPS T10 ON T9."position"= T10."name"
LEFT JOIN OWDD T11 ON T0."DocEntry"=T11."DocEntry" AND T0."ObjType"=T11."ObjType"

LEFT JOIN OUSR T12 ON T0."UserSign" = T12."USERID"
LEFT JOIN OHEM T13 ON T12."USERID"= T13."userId"
LEFT JOIN OHPS T14 ON T13."position"= T14."name"
		
WHERE T0."DocEntry" = :DocKey;
END;

USE [Test4]
GO
/****** Object:  StoredProcedure [dbo].[crystal_sp_get_purchase_order]    Script Date: 6/6/2019 11:35:19 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE  [dbo].[crystal_sp_get_purchase_order]
--(IN DocKey decimal(19, 0)) 
@Dockey numeric(18)
AS 
BEGIN 
SELECT 'PURCHASE ORDER' AS "Report Name",
		CAST(T0."DocNum" AS varchar(50)) AS "PO No", 
		T0."TaxDate" AS "PO Date", 
		T0."NumAtCard" AS "Ref No", 
		T6."PymntGroup", 
		T0."DocDueDate" AS "Desired Ship Date", 
		T0."CardName" AS "Vendor Name", 
		T0."Address2" AS "Vendor Address", 
		T3."Name" AS "Contact Person Name", 
		T3."E_MailL" AS "Contact Person Email", 
		T3."Tel1" AS "Contact Person Tel1", 
		T3."Fax" AS "Contact Person Fax", 
		T0."DocCur", 
		T0."DocRate", 
		'Zambian Kwacha' AS "Currencyname", 
		'Ngwee' AS "Hundredthname", 
		T1."ItemCode", 
		T1."Dscription", 
		T1."Quantity", 
		T1."unitMsr", 
		T1."Price", 
		T1."DiscPrcnt", 
		T1."VatPrcnt", 
		T1."LineTotal",
		T1."TotalFrgn", 
		T0."VatSum", 
		T0."VatSumFC", 

		T0."DocTotal", 
		T0."DocTotalFC", 

		T0."Comments" AS "Special Instructions" ,
		T7."Address" AS "Company Address",
		T8."U_NAME" AS "Prepared By",
		T10."name" AS "Prepared By Desig",
		T8."E_Mail" AS "Prepared By Email",
		T8."PortNum" AS "Prepared By Contact",

		T12."U_NAME" AS "Authorised By",
		T14."name" AS "Authorised By Desig",
		T12."E_Mail" AS "Authorised By Email",
		T12."PortNum" AS "Authorised By Contact"

		FROM  OPOR T0 
		INNER JOIN POR1 T1 ON T0."DocEntry" = T1."DocEntry" 
		INNER JOIN OCRN T2 ON T0."DocCur" = T2."CurrCode" 
		LEFT OUTER JOIN OCPR T3 ON T0."CardCode" = T3."CardCode" 
				  AND T0."CntctCode" = T3."CntctCode" 
		INNER JOIN NNM1 T5 ON T0."Series" = T5."Series" 
		LEFT OUTER JOIN OCTG T6 ON T0."GroupNum" = T6."GroupNum"
		LEFT OUTER JOIN OBPL T7 on T7."BPLId" = T0."BPLId"
		LEFT JOIN OUSR T8 ON T0."UserSign" = T8."USERID"
		LEFT JOIN OHEM T9 ON T8."USERID"= T9."userId"
		LEFT JOIN OHPS T10 ON T9."position"= T10."name"
		LEFT JOIN OWDD T11 ON T0."DocEntry"=T11."DocEntry" AND T0."ObjType"=T11."ObjType"

		LEFT JOIN OUSR T12 ON T0."UserSign" = T12."USERID"
		LEFT JOIN OHEM T13 ON T12."USERID"= T13."userId"
		LEFT JOIN OHPS T14 ON T13."position"= T14."name"
		WHERE T0."DocEntry" = @Dockey --:DocKey;
END;